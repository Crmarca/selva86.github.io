<!DOCTYPE html>
<html>
  <head>
    <title>ggplot2 Tutorial - r-statistics.co</title>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="shortcut icon" href="/screenshots/iconb-64.png" type="image/x-icon" />
    <link href="www/bootstrap.min.css" rel="stylesheet">
    <link href="www/highlight.css" rel="stylesheet">

    <link href='http://fonts.googleapis.com/css?family=Inconsolata:400,700'
      rel='stylesheet' type='text/css'>
    <!-- Color Script -->
    <style type="text/css">
      a {
       color: #3675C5;
       color: rgb(25, 145, 248);
       color: #4582ec;
       color: #3F73D8;
      }
      /* reduce spacing around math formula*/
      .MathJax_Display {
        margin: 0em 0em;
      }   
    </style>
    <!-- Add Google search -->
    <script language="Javascript" type="text/javascript">
  function my_search_google()
  {
    var query = document.getElementById("my-google-search").value;
    window.open("http://google.com/search?q=" + query
	+ "%20site:" + "http://r-statistics.co");
  }
</script>
  </head>

  <body>

    <div class="container">

      <div class="masthead">
       <!--
        <ul class="nav nav-pills pull-right">
          <li class="dropdown">
            <a href="#" class="dropdown-toggle" data-toggle="dropdown">
              Table of contents<b class="caret"></b>
            </a>
            <ul class="dropdown-menu pull-right" role="menu">
              <li class="dropdown-header"></li>
<li class="dropdown-header">Tutorial</li>
<li><a href="R-Tutorial.html">R Tutorial</a></li>
<li class="dropdown-header">Foundations</li>
<li><a href="Linear-Regression.html">Linear Regression</a></li>
<li><a href="Assumptions-of-Linear-Regression.html">Assumptions of Linear Regression</a></li>
<li><a href="Statistical-Tests-in-R.html">Statistical Tests</a></li>
<li><a href="Variable-Selection-and-Importance-With-R.html">Feature Selection</a></li>
<li><a href="Model-Selection-in-R.html">Model Selection</a></li>
<li><a href="Logistic-Regression-With-R.html">Logistic Regression</a></li>
<li><a href="Environments.html">Advanced Linear Regression</a></li>

<li class="dropdown-header">Advanced Regression Models</li>
<li><a href="adv-regression-models.html">Advanced Regression Models</a></li>

<li class="dropdown-header">Time Series</li>
<li><a href="Time-Series-Analysis-With-R.html">Time Series Analysis</a></li>
<li><a href="Time-Series-Forecasting-With-R.html">Time Series Forecasting </a></li>
<li><a href="Time-Series-Forecasting-With-R-part2.html">More Time Series Forecasting</a></li>

<li class="dropdown-header">High Performance Computing</li>
<li><a href="Parallel-Computing-With-R.html">Parallel computing</a></li>
<li><a href="Strategies-To-Improve-And-Speedup-R-Code.html">Strategies to Speedup R code</a></li>

<li class="dropdown-header">Useful Techniques</li>
<li><a href="Association-Mining-With-R.html">Association Mining</a></li>
<li><a href="Multi-Dimensional-Scaling-With-R.html">Multi Dimensional Scaling</a></li>
<li><a href="Profiling.html">Optimization</a></li>
<li><a href="Information-Value-With-R.html">InformationValue package</a></li>

            </ul>
          </li>
        </ul>
        -->

        <ul class="nav nav-pills pull-right">
          <div class="input-group">
            <form onsubmit="my_search_google()">
                <input type="text" class="form-control" id="my-google-search" placeholder="Search..">
            <form>
          </div><!-- /input-group -->
        </ul><!-- /.col-lg-6 -->

        <h3 class="muted"><a href="/">r-statistics.co</a></h3>
        <hr>
      </div>

      <div class="row">
        <div class="col-xs-12 col-sm-3" id="nav">
        <div class="well">
          <li>
            <ul class="list-unstyled">
                <li class="dropdown-header"></li>
<li class="dropdown-header">Tutorial</li>
<li><a href="R-Tutorial.html">R Tutorial</a></li>
<li class="dropdown-header">Foundations</li>
<li><a href="Linear-Regression.html">Linear Regression</a></li>
<li><a href="Assumptions-of-Linear-Regression.html">Assumptions of Linear Regression</a></li>
<li><a href="Statistical-Tests-in-R.html">Statistical Tests</a></li>
<li><a href="Variable-Selection-and-Importance-With-R.html">Feature Selection</a></li>
<li><a href="Model-Selection-in-R.html">Model Selection</a></li>
<li><a href="Logistic-Regression-With-R.html">Logistic Regression</a></li>
<li><a href="Environments.html">Advanced Linear Regression</a></li>

<li class="dropdown-header">Advanced Regression Models</li>
<li><a href="adv-regression-models.html">Advanced Regression Models</a></li>

<li class="dropdown-header">Time Series</li>
<li><a href="Time-Series-Analysis-With-R.html">Time Series Analysis</a></li>
<li><a href="Time-Series-Forecasting-With-R.html">Time Series Forecasting </a></li>
<li><a href="Time-Series-Forecasting-With-R-part2.html">More Time Series Forecasting</a></li>

<li class="dropdown-header">High Performance Computing</li>
<li><a href="Parallel-Computing-With-R.html">Parallel computing</a></li>
<li><a href="Strategies-To-Improve-And-Speedup-R-Code.html">Strategies to Speedup R code</a></li>

<li class="dropdown-header">Useful Techniques</li>
<li><a href="Association-Mining-With-R.html">Association Mining</a></li>
<li><a href="Multi-Dimensional-Scaling-With-R.html">Multi Dimensional Scaling</a></li>
<li><a href="Profiling.html">Optimization</a></li>
<li><a href="Information-Value-With-R.html">InformationValue package</a></li>

            </ul>
          </li>
        </div>

        <div class="well">
          Stay up-to-date. <a href="https://docs.google.com/forms/d/1xkMYkLNFU9U39Dd8S_2JC0p8B5t6_Yq6zUQjanQQJpY/viewform">Subscribe!</a>
        </div>

        
        <h4>Contents</h4>
        

          <ul class="list-unstyled" id="toc"></ul>
        <!--
          <hr>
          <p><a href="/contribute.html">How to contribute</a></p>

          <p><a class="btn btn-primary" href="">Edit this page</a></p>
        -->  
        </div>

        <div id="content" class="col-xs-12 col-sm-8 pull-right">

          <h1>How to make any plot in ggplot2?</h1>
<blockquote>
<p>ggplot2 is the most elegant and aesthetically pleasing graphics framework available in R.</p>
</blockquote>
<p>The distinctive feature of the ggplot2 framework is the way you make plots through adding ‘layers’. The process of making any ggplot is as follows.</p>
<h2>1. The Setup</h2>
<p>First, you need to tell ggplot what dataset to use using the <code>ggplot()</code> function. Optionally you can add whatever information is known at the time of setup - such as X and Y axes, color, size, shape and stroke. If you intend to add more layers later one, may be a bar chart on top of a line graph, you can specify the respective aesthetics when you add those layers.</p>
<p>Below, I show few examples of how to setup ggplot using in the <code>diamonds</code> dataset that comes with <code>ggplot2</code> itself.</p>
<h5>Examples:</h5>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(ggplot2)
<span class="kw">ggplot</span>(diamonds)  <span class="co"># if only the dataset is known.</span>
<span class="kw">ggplot</span>(diamonds, <span class="kw">aes</span>(<span class="dt">x=</span>carat))  <span class="co"># if only X-axis is known. The Y-axis can be specified in respective geoms.</span>
<span class="kw">ggplot</span>(diamonds, <span class="kw">aes</span>(<span class="dt">x=</span>carat, <span class="dt">y=</span>price))  <span class="co"># if both X and Y axes are known.</span>
<span class="kw">ggplot</span>(diamonds, <span class="kw">aes</span>(<span class="dt">x=</span>carat, <span class="dt">color=</span>cut))  <span class="co"># Each category of the &#39;cut&#39; variable will now have a distinct  color, once a geom is added.</span></code></pre></div>
<p>The <code>aes</code> argument stands for aesthetics. ggplot2 considers the X and Y axis of the plot to be aesthetics as well, along with color, size, shape, fill etc.</p>
<h2>2. The Layers</h2>
<p>The layers in ggplot2 are also called ‘<em>geoms</em>’. Once the base setup is done, you can append the geoms one on top of the another. The <a href="http://docs.ggplot2.org/current/">documentation</a> provides a compehensive list of all available <em>geoms</em>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(ggplot2)
<span class="kw">ggplot</span>(diamonds, <span class="kw">aes</span>(<span class="dt">x=</span>carat, <span class="dt">y=</span>price, <span class="dt">color=</span>cut)) +<span class="st"> </span><span class="kw">geom_point</span>() +<span class="st"> </span><span class="kw">geom_smooth</span>() <span class="co"># Adding scatterplot geom (layer1) and smoothing geom (layer2).</span></code></pre></div>
<p><img src='screenshots/ggplot_1.png' width=698 height=349 /></p>
<p>We have added two layers (geoms) to this plot - the <code>geom_point()</code> and <code>geom_smooth()</code>.</p>
<p>Notice the X and Y axis and how the color of the points vary based on the value of <code>cut</code> variable. The legend is automatically added, though the legend title needs a fix. Fixing the legend title falls under the jurisdiction of themes. Here is a quick challenge for you. Can you make the shape of the points vary with <code>color</code> feature?</p>
<p>Though setting up took us quite a bit of code, adding further complexity such as the layers, distinct color for each cut etc was easy. Imagine how much code you would have had to write if you were to make this in base graphics? Thanks to ggplot2!</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Answer to the challenge.</span>
<span class="kw">ggplot</span>(diamonds, <span class="kw">aes</span>(<span class="dt">x=</span>carat, <span class="dt">y=</span>price, <span class="dt">color=</span>cut, <span class="dt">shape=</span>color)) +<span class="st"> </span><span class="kw">geom_point</span>()</code></pre></div>
<h2>3. The Labels</h2>
<p>Now that you have drawn the main parts of the graph. You might want to add the plot’s main title and perhaps change the X and Y axis titles. This can be accomplished using the <code>labs</code> layer, meant for specifying the labels. However, manipulating the size, color of the labels is the job of the ‘Theme’.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(ggplot2)
gg &lt;-<span class="st"> </span><span class="kw">ggplot</span>(diamonds, <span class="kw">aes</span>(<span class="dt">x=</span>carat, <span class="dt">y=</span>price, <span class="dt">color=</span>cut)) +<span class="st"> </span><span class="kw">geom_point</span>() +<span class="st"> </span><span class="kw">labs</span>(<span class="dt">title=</span><span class="st">&quot;Scatterplot&quot;</span>, <span class="dt">x=</span><span class="st">&quot;Carat&quot;</span>, <span class="dt">y=</span><span class="st">&quot;Price&quot;</span>)  <span class="co"># add axis lables and plot title.</span>
<span class="kw">print</span>(gg)</code></pre></div>
<p><img src='screenshots/ggplot_2.png' width=698 height=349 /></p>
<p>The plot’s main title is added and the X and Y axis labels capitalized.</p>
<p><strong>Note</strong>: If you are showing a ggplot inside a function, you need to explicitly save it and then print using the <code>print(gg)</code>, like we just did above.</p>
<h2>4. The Theme</h2>
<p>Almost everything is set, except that we want to increase the size of the labels and change the legend title. Adjusting the size of labels can be done using the <code>theme()</code> function by setting the <code>plot.title</code>, <code>axis.text.x</code> and <code>axis.text.y</code>. They need to be specified inside the <code>element_text()</code>. If you want to remove any of them, set it to <code>element_blank()</code> and it will vanish entirely.</p>
<p>Adjusting the legend title is a bit tricky. If your legend is that of a <code>color</code> attribute and it varies based in a factor, you need to set the <code>name</code> using <code>scale_color_discrete()</code>, where the <em>color</em> part belongs to the color attribute and the <em>discrete</em> because the legend is based on a factor variable.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(ggplot2)
gg1 &lt;-<span class="st"> </span>gg +<span class="st"> </span><span class="kw">theme</span>(<span class="dt">plot.title=</span><span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">30</span>, <span class="dt">face=</span><span class="st">&quot;bold&quot;</span>), 
                  <span class="dt">axis.text.x=</span><span class="kw">element_text</span>(<span class="dt">angle=</span><span class="dv">45</span>, <span class="dt">size=</span><span class="dv">15</span>), 
                  <span class="dt">axis.text.y=</span><span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">15</span>),
                  <span class="dt">axis.title.x=</span><span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">25</span>),
                  <span class="dt">axis.title.y=</span><span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">25</span>)) +<span class="st"> </span>
<span class="st">  </span><span class="kw">scale_color_discrete</span>(<span class="dt">name=</span><span class="st">&quot;Cut of diamonds&quot;</span>)  <span class="co"># add title and axis text, change legend title.</span>
<span class="kw">print</span>(gg1)  <span class="co"># print the plot</span></code></pre></div>
<p><img src='screenshots/ggplot_3.png' width=698 height=349 /></p>
<p>If the legend shows a shape attribute based on a factor variable, you need to change it using <code>scale_shape_discrete()</code>. Had it been a continuous variable, use <code>scale_shape_continuous()</code> instead.</p>
<p>So now, Can you guess the function to use if your legend is based on a <code>fill</code> attribute on a continuous variable?</p>
<p>The answer is <code>scale_fill_continuous()</code>.</p>
<h2>5. The Facets</h2>
<h2>6. Commonly Used Features</h2>
<h2>6.1 Make a time series plot (using autoplot and ggfortify)</h2>
<h2>6.2 Make multiple timeseries on same plot</h2>
<h2>6.3 Change themes</h2>
<h2>6.4 Legend inside the plot</h2>
<h2>6.5 Grid lines</h2>
<h2>6.6 Grid lines over the plot items</h2>
<h2>6.7 Annotation</h2>
<h2>6.8 Saving ggplot</h2>
<h2>7. The Cheatsheet (Separate Post)</h2>
<p>All items from <a href="http://zevross.com/blog/2014/08/04/beautiful-plotting-in-r-a-ggplot2-cheatsheet-3/" class="uri">http://zevross.com/blog/2014/08/04/beautiful-plotting-in-r-a-ggplot2-cheatsheet-3/</a></p>
<p>All items from <a href="http://www.computerworld.com/article/2935394/business-intelligence/my-ggplot2-cheat-sheet-search-by-task.html" class="uri">http://www.computerworld.com/article/2935394/business-intelligence/my-ggplot2-cheat-sheet-search-by-task.html</a></p>
<h5>Change Plot background</h5>
<h5>Flipping coordinates</h5>
<h5>Set the X and Y axis limits.</h5>


        </div>
      </div>

      <div class="footer">
        <hr>
        <p>&copy; 2015 Selva Prabhakaran. Powered by <a href="http://jekyllrb.com/">jekyll</a>,
          <a href="http://yihui.name/knitr/">knitr</a>, and
          <a href="http://johnmacfarlane.net/pandoc/">pandoc</a>.
          This work is licensed under the <a href="http://creativecommons.org/licenses/by-nc/3.0/">Creative Commons License.</a>
        </p>
      </div>

    </div> <!-- /container -->

  <script src="//code.jquery.com/jquery.js"></script>
  <script src="www/bootstrap.min.js"></script>
  <script src="www/toc.js"></script>
  <!-- MathJax Script -->
  <script type="text/x-mathjax-config">
    MathJax.Hub.Config({
      tex2jax: {inlineMath: [['$','$'], ['\\(','\\)']]}
    });
  </script>
  <script type="text/javascript"
    src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
  </script>
  <!-- Google Analytics Code -->
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-69351797-1', 'auto');
    ga('send', 'pageview');
  </script>

  <style type="text/css">
  /* reduce spacing around math formula*/
    .MathJax_Display {
      margin: 0em 0em;
    }
  </style>
  </body>
</html>