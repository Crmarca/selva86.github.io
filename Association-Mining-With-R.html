<!DOCTYPE html>
<html>
  <head>
    <title>Association Mining - r-statistics.co</title>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="shortcut icon" href="/screenshots/iconb-64.png" type="image/x-icon" />
    <link href="www/bootstrap.min.css" rel="stylesheet">
    <link href="www/highlight.css" rel="stylesheet">

    <link href='http://fonts.googleapis.com/css?family=Inconsolata:400,700'
      rel='stylesheet' type='text/css'>
    <!-- Color Script -->
    <style type="text/css">
      a {
       color: #3675C5;
       color: rgb(25, 145, 248);
       color: #4582ec;
       color: #3F73D8;
      }
      /* reduce spacing around math formula*/
      .MathJax_Display {
        margin: 0em 0em;
      }   
    </style>
    <!-- Add Google search -->
    <script language="Javascript" type="text/javascript">
  function my_search_google()
  {
    var query = document.getElementById("my-google-search").value;
    window.open("http://google.com/search?q=" + query
	+ "%20site:" + "http://r-statistics.co");
  }
</script>
  </head>

  <body>

    <div class="container">

      <div class="masthead">
       <!--
        <ul class="nav nav-pills pull-right">
          <li class="dropdown">
            <a href="#" class="dropdown-toggle" data-toggle="dropdown">
              Table of contents<b class="caret"></b>
            </a>
            <ul class="dropdown-menu pull-right" role="menu">
              <li class="dropdown-header"></li>
<li class="dropdown-header">Tutorial</li>
<li><a href="R-Tutorial.html">R Tutorial</a></li>
<li class="dropdown-header">Foundations</li>
<li><a href="Linear-Regression.html">Linear Regression</a></li>
<li><a href="Assumptions-of-Linear-Regression.html">Assumptions of Linear Regression</a></li>
<li><a href="Statistical-Tests-in-R.html">Statistical Tests</a></li>
<li><a href="Variable-Selection-and-Importance-With-R.html">Feature Selection</a></li>
<li><a href="Model-Selection-in-R.html">Model Selection</a></li>
<li><a href="Logistic-Regression-With-R.html">Logistic Regression</a></li>
<li><a href="Environments.html">Advanced Linear Regression</a></li>

<li class="dropdown-header">Advanced Regression Models</li>
<li><a href="adv-regression-models.html">Advanced Regression Models</a></li>

<li class="dropdown-header">Time Series</li>
<li><a href="Time-Series-Analysis-With-R.html">Time Series Analysis</a></li>
<li><a href="Time-Series-Forecasting-With-R.html">Time Series Forecasting </a></li>
<li><a href="Time-Series-Forecasting-With-R-part2.html">More Time Series Forecasting</a></li>

<li class="dropdown-header">High Performance Computing</li>
<li><a href="Parallel-Computing-With-R.html">Parallel computing</a></li>
<li><a href="Strategies-To-Improve-And-Speedup-R-Code.html">Strategies to Speedup R code</a></li>

<li class="dropdown-header">Useful Techniques</li>
<li><a href="Association-Mining-With-R.html">Association Mining</a></li>
<li><a href="Multi-Dimensional-Scaling-With-R.html">Multi Dimensional Scaling</a></li>
<li><a href="Profiling.html">Optimization</a></li>

            </ul>
          </li>
        </ul>
        -->

        <ul class="nav nav-pills pull-right">
          <div class="input-group">
            <form onsubmit="my_search_google()">
                <input type="text" class="form-control" id="my-google-search" placeholder="Search..">
            <form>
          </div><!-- /input-group -->
        </ul><!-- /.col-lg-6 -->

        <h3 class="muted"><a href="/">r-statistics.co</a></h3>
        <hr>
      </div>

      <div class="row">
        <div class="col-xs-12 col-sm-3" id="nav">
        <div class="well">
          <li>
            <ul class="list-unstyled">
                <li class="dropdown-header"></li>
<li class="dropdown-header">Tutorial</li>
<li><a href="R-Tutorial.html">R Tutorial</a></li>
<li class="dropdown-header">Foundations</li>
<li><a href="Linear-Regression.html">Linear Regression</a></li>
<li><a href="Assumptions-of-Linear-Regression.html">Assumptions of Linear Regression</a></li>
<li><a href="Statistical-Tests-in-R.html">Statistical Tests</a></li>
<li><a href="Variable-Selection-and-Importance-With-R.html">Feature Selection</a></li>
<li><a href="Model-Selection-in-R.html">Model Selection</a></li>
<li><a href="Logistic-Regression-With-R.html">Logistic Regression</a></li>
<li><a href="Environments.html">Advanced Linear Regression</a></li>

<li class="dropdown-header">Advanced Regression Models</li>
<li><a href="adv-regression-models.html">Advanced Regression Models</a></li>

<li class="dropdown-header">Time Series</li>
<li><a href="Time-Series-Analysis-With-R.html">Time Series Analysis</a></li>
<li><a href="Time-Series-Forecasting-With-R.html">Time Series Forecasting </a></li>
<li><a href="Time-Series-Forecasting-With-R-part2.html">More Time Series Forecasting</a></li>

<li class="dropdown-header">High Performance Computing</li>
<li><a href="Parallel-Computing-With-R.html">Parallel computing</a></li>
<li><a href="Strategies-To-Improve-And-Speedup-R-Code.html">Strategies to Speedup R code</a></li>

<li class="dropdown-header">Useful Techniques</li>
<li><a href="Association-Mining-With-R.html">Association Mining</a></li>
<li><a href="Multi-Dimensional-Scaling-With-R.html">Multi Dimensional Scaling</a></li>
<li><a href="Profiling.html">Optimization</a></li>

            </ul>
          </li>
        </div>

        <div class="well">
          Want to get involved? <a href="mailto:rcodeprogramming@gmail.com">Let me know!</a>.
        </div>

        
        <h4>Contents</h4>
        

          <ul class="list-unstyled" id="toc"></ul>
        <!--
          <hr>
          <p><a href="/contribute.html">How to contribute</a></p>

          <p><a class="btn btn-primary" href="">Edit this page</a></p>
        -->  
        </div>

        <div id="content" class="col-xs-12 col-sm-8 pull-right">

          <h1>Association Mining (Market Basket Analysis)</h1>
<blockquote>
<p>Association mining is commonly used to make product recommendations by identifying products that are frequently bought together. But, if you are not careful, the rules can give misleading results in certain cases . Lets find out how..</p>
</blockquote>
<p>Association mining is usually done on transactions data from a retail market or from an online e-commerce store. Since most transactions data is large, the <code>apriori</code> algorithm makes it easier to find these patterns or <em>rules</em> quickly.</p>
<p>So, What is a <em>rule</em>?</p>
<p>A rule is a notation that represents which item/s is frequently bought with what item/s. It has an <em>LHS</em> and an <em>RHS</em> part and can be represented as follows:</p>
<p><strong>itemset A =&gt; itemset B</strong></p>
<p>This means, the item/s on the right were frequently purchased along with items on the left.</p>
<h2>How to measure the strength of a rule?</h2>
<p>The <code>apriori()</code> generates the most relevent set of rules from a given transaction data. It also shows the <em>support</em>, <em>confidence</em> and <em>lift</em> of those rules. These three measure can be used to decide the relative strength of the rules. So what do these terms mean?</p>
<p>Lets consider the rule <strong>A =&gt; B</strong> in order to compute these metrics.</p>
<p><br /><span class="math display">$$Support = \frac{Number\ of\ transactions\ with\ both\ A\ and\ B}{Total\ number\ of\ transactions} = P\left(A \cap B\right)$$</span><br /></p>
<p><br /><span class="math display">$$Confidence = \frac{Number\ of\ transactions\ with\ both\ A\ and\ B}{Total\ number\ of\ transactions\ with\ A} = \frac{P\left(A \cap B\right)}{P\left(A\right)}$$</span><br /></p>
<p><br /><span class="math display">$$Expected Confidence = \frac{Number\ of\ transactions\ with\ B}{Total\ number\ of\ transactions} = P\left(B\right)$$</span><br /></p>
<p><br /><span class="math display">$$Lift = \frac{Confidence}{Expected\ Confidence} = \frac{P\left(A \cap B\right)}{P\left(A\right).P\left(B\right)}$$</span><br /></p>
<h2>Caveat with using Lift</h2>
<p>The directionality of the rule is lost when <em>lift</em> is used. That is, the lift of any rule, <em>A =&gt; B</em> and the rule <em>B =&gt; A</em> will be the same. See the calculation below:</p>
<h4><em>A -&gt; B</em></h4>
<ul>
<li><p>Support: <span class="math inline"><em>P</em>(<em>A</em>∩<em>B</em>)</span></p></li>
<li><p>Confidence: <span class="math inline">$\frac{P\left( A \cap B \right)}{P\left( A \right)}$</span></p></li>
<li><p>Expected Confidence: <span class="math inline"><em>P</em>(<em>B</em>)</span></p></li>
<li><p>Lift: <span class="math inline">$\frac{Confidence}{Expected\ Confidence}$</span> = <span class="math inline">$\frac{P\left( A \cap B \right)}{P\left( A \right).P\left( B \right)}$</span></p></li>
</ul>
<h4><em>B -&gt; A</em></h4>
<ul>
<li><p>Support: <span class="math inline"><em>P</em>(<em>A</em>∩<em>B</em>)</span></p></li>
<li><p>Confidence: <span class="math inline">$\frac{P\left( A \cap B \right)}{P\left( B \right)}$</span></p></li>
<li><p>Expected Confidence: <span class="math inline"><em>P</em>(<em>B</em>)</span></p></li>
<li><p>Lift: <span class="math inline">$\frac{Confidence}{Expected\ Confidence}$</span> = <span class="math inline">$\frac{P\left( A \cap B \right)}{P\left( A \right).P\left( B \right)}$</span></p></li>
</ul>
<h4>Important Note</h4>
<p>For both rules <em>A -&gt; B</em> and <em>B -&gt; A</em>, the value of <em>lift</em> and support turns out to be the same. This means we cannot use lift to make recommendation for a particular <em>directional</em> ‘rule’. It can merely be used to club frequently bought items into groups.</p>
<h2>Caveat with using Confidence</h2>
<p>The <em>confidence</em> of a rule can be a misleading measure while making product recommendations in real world problems, especially while making <em>add-ons</em> product recommendations. Lets consider the following data with 4 transactions, involving IPhones and Headsets:</p>
<ol style="list-style-type: decimal">
<li>Iphone, Headset</li>
<li>Iphone, Headset</li>
<li>Iphone</li>
<li>Iphone</li>
</ol>
<p>We can create 2 rules for these transactions as shown below:</p>
<ol style="list-style-type: decimal">
<li><em>Iphone -&gt; Headset</em></li>
<li><em>Headset -&gt; IPhone</em></li>
</ol>
<p>In real world, it would be realistic to recommend <em>headphones</em> to a person who just bought an <em>iPhone</em> and not the other way around. Imagine being recommended an iPhone when you just finished purchasing a pair of headphones. Not nice!.</p>
<p>While selecting rules from the <code>apriori</code> output, you might guess that higher the confidence a rule has, better is the rule. But for cases like this, the headset -&gt; iPhone rule will have a higher confidence (2 times) over iPhone -&gt; headset. Can you see why? The calculation below show how.</p>
<h4>Confidence Calculation:</h4>
<p><strong>iPhone -&gt; Headset</strong>: <span class="math inline">$\frac{P(iPhone\ \cap\ Headset)}{P(iPhone)}$</span> = 0.5 / 1 = <strong>0.5</strong></p>
<p><strong>Headset -&gt; iPhone</strong>: <span class="math inline">$\frac{P(iPhone\ \cap\ Headset)}{P(Headset)}$</span> = 0.5 / 0.5 = <strong>1.0</strong></p>
<p>As, you can see, the <em>headset -&gt; iPhone</em> recommendation has a higher confidence, which is misleading and unrealistic. So, confidence should not be the <em>only measure</em> you should use to make product recommendations.</p>
<p>So, you probably need to check more criteria such as the price of products, product types etc before recommending items, especially in cross selling cases.</p>


        </div>
      </div>

      <div class="footer">
        <hr>
        <p>&copy; 2015 Selva Prabhakaran. Powered by <a href="http://jekyllrb.com/">jekyll</a>,
          <a href="http://yihui.name/knitr/">knitr</a>, and
          <a href="http://johnmacfarlane.net/pandoc/">pandoc</a>. Source
          available on <a href="https://github.com/selva86/selva86.github.io/">github</a>.
          This work is licensed under the <a href="http://creativecommons.org/licenses/by-nc/3.0/">Creative Commons License.</a>
        </p>
      </div>

    </div> <!-- /container -->

  <script src="//code.jquery.com/jquery.js"></script>
  <script src="www/bootstrap.min.js"></script>
  <script src="www/toc.js"></script>
  <!-- MathJax Script -->
  <script type="text/x-mathjax-config">
    MathJax.Hub.Config({
      tex2jax: {inlineMath: [['$','$'], ['\\(','\\)']]}
    });
  </script>
  <script type="text/javascript"
    src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
  </script>
  <!-- Google Analytics Code -->
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-69351797-1', 'auto');
    ga('send', 'pageview');
  </script>

  <style type="text/css">
  /* reduce spacing around math formula*/
    .MathJax_Display {
      margin: 0em 0em;
    }
  </style>
  </body>
</html>